<!DOCTYPE html>
<html lang="ko" xmlns:th="http://thymeleaf.org" th:class="sub-page">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>객실 선택 | HOTEL MIMIR</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
<link rel="stylesheet" th:href="@{/css/room/room_list.css}" />
 <link rel="stylesheet" th:href="@{/css/header.css}" />
 <link rel="stylesheet" th:href="@{/css/footer.css}" />
<script th:src="@{/js/room/room_list.js}"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>
<style>
</style>
  
<script>
</script>
</head>
<body>
	<div th:replace="~{fragments/header.html :: header}"></div>

	<div class="step-indicator">
		<span class="step current">1</span> <span class="step-title">객실 선택</span> 
		<span class="step" data-tooltip="옵션 및 예약정보 입력">2</span> 
		<span class="step" data-tooltip="예약 완료">3</span>
	</div>
	<div class="hotel-info">
		<div class="hotel-name">
			<strong>미미르 호텔</strong>
		</div>
		<div class="info-group">
			<span><strong>호텔등급:</strong> 5등급</span> <span>|</span> <span><strong>주소:</strong>
				서울특별시 강남구 역삼동 테헤란로 132 한독약품빌딩 8층</span> <span>|</span> <span><strong>체크인/아웃:</strong>
				15:00 / 11:00</span>
		</div>
	</div>

<div class="filter-bar">
  <!-- 정렬 기준 아코디언 -->

<div class="accordion bed-accordion">
    <button class="accordion-btn">정렬 기준</button>
    <div class="accordion-content" style="min-height: 100px;">
    <p style="position: relative; left: 30px; bottom: 10px;">정렬 기준</p>
     <div class="accordion-content-sub">
     <hr style="position: relative; bottom: 10px; right: 20px">
      <div class="filter-tags" style=" position: relative; bottom: 10px">
        <button class="tag-btn selected">낮은 요금순</button>
        <button class="tag-btn">높은 요금순</button>
      </div>
      </div>
    </div>
  </div>
  
  <!-- 침대 타입 필터 -->
  <div class="accordion bed-accordion">
    <button class="accordion-btn">침대 타입</button>
    <div class="accordion-content">
     <div class="accordion-content-sub">
      <p>2개 이상 선택 가능</p>
      <div class="filter-tags">
        <button class="tag-btn">더블</button>
        <button class="tag-btn">트윈</button>
        <button class="tag-btn">트리플</button>
        <button class="tag-btn">패밀리 트윈</button>
      </div>
      </div>
      <div class="accordion-hr">
      <hr>
       <div class="accordion-content-sub accordion-hr2">
      <button class="reset-btn">⟳ 선택해제</button>
      </div>
      </div>
    </div>
  </div>

  <!-- 전망 타입 필터 -->
  <div class="accordion view-accordion">
    <button class="accordion-btn">전망 타입</button>
    <div class="accordion-content">
    <div class="accordion-content-sub">
      <p>2개 이상 선택 가능</p>
      <div class="filter-tags">
        <button class="tag-btn">시티뷰</button>
        <button class="tag-btn">리버뷰</button>
      </div>
    </div>
    <div class="accordion-hr">
      <hr>
       <div class="accordion-content-sub accordion-hr2">
      <button class="reset-btn">⟳ 선택해제</button>
    </div>
      </div>
    </div>
  </div>
</div>

	<div class="room-section">
	<div class="room-list">
<th:block th:each="room : ${roomList}">
  <div class="room-card" style="position: relative;" th:attr="data-capacity=${room.capacity}">
    
    <!-- ✅ 잔여 객실 표시 추가 -->
    <div class="available-count" 
         th:text="'잔여 객실: ' + ${room.countAvailableRooms} + '개'"
         style="
             position: absolute;
             top: 10px;
             left: 10px;
             background-color: rgba(0,0,0,0.7);
             color: #fff;
             padding: 4px 8px;
             border-radius: 5px;
             font-size: 0.8rem;
         ">
    </div>
    
    <img th:src="${room.imagePath}" alt="room" />

    <div class="room-info">
      <h3 th:text="${room.typeName}">스탠다드룸</h3>
      <p th:text="'위치: ' + ${room.floorType}">위치: 저층</p>
      <p th:text="'침대타입: ' + ${room.bedName}">침대타입: 더블</p>
      <p th:text="'전망: ' + ${room.viewName}">전망: 시티뷰, 리버뷰</p>
    </div>
    <a th:href="${room.countAvailableRooms > 0} ? @{/room_resv/resvRoom(roomId=${room.roomId})} : '#'"
   th:classappend="${room.countAvailableRooms == 0} ? ' disabled' : ''"
   class="price-btn"
   th:text="'₩' + ${#numbers.formatInteger(room.pricePerNight, 3, 'COMMA')}">₩700,000</a>
  </div>
</th:block>     
	</div>

		<div class="reservation-summary">
			<p onclick="openModal('dateModal')" role="button" tabindex="0">
				<strong>체크인 / 아웃</strong><br />
				<span class="date-range-placeholder">날짜 선택</span>
				<span class="arrow">▸</span>
			</p>
			<p onclick="openModal('guestModal')" role="button" tabindex="0">
				<strong>인원</strong><br />
				<span class="guest-placeholder">성인 2, 아동 0</span>
				<span class="arrow">▸</span>
			</p>
		</div>
	</div>

	 <div class="modal-overlay" id="overlay" onclick="closeModal()"></div>

  <div class="modal" id="dateModal" role="dialog" aria-modal="true" aria-labelledby="dateModalTitle">
    <div class="modal-header">
      <h3 id="dateModalTitle">체크인 / 아웃</h3>
      <button class="modal-close-btn" aria-label="닫기" onclick="closeModal()">×</button>
    </div>
    <hr />
    <div class="modal-body">
      <div id="datepicker"></div>
    </div>
    <div class="modal-footer">
      <button onclick="confirmDateSelection()">선택</button>
    </div>
  </div>

	<!-- 객실/인원 선택 모달 -->
	<div class="modal" id="guestModal" role="dialog" aria-modal="true" aria-labelledby="guestModalTitle">
  <h3 id="guestModalTitle">인원 선택</h3>
  <div class="guest-form">
    <div class="field">
      <label for="adultCount">성인 인원</label>
      <input id="adultCount" type="number" value="2" min="1" />
    </div>
    <div class="field">
      <label for="childCount">아동 인원</label>
      <input id="childCount" type="number" value="0" min="0" />
    </div>
    <div class="modal-footer right-align">
      <button onclick="confirmGuestSelection()">확인</button>
    </div>
  </div>
</div>
<div th:replace="~{fragments/footer.html :: footerFragment}"></div>
</body>
</html>
