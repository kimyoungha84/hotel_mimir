<!DOCTYPE html>
<html xmlns="http://www.thymeleaf.org" lang="ko">
<head>
  <link rel="icon shortcut" href="/admin_common_assets/common_img/mimir_favicon.ico"/>
  <link rel="stylesheet" href="/css/admin_chat.css" />
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
  <th:block th:replace="~{/administrator/fragments/admin_header :: admin_header}"></th:block>
</head>
<body>
  <th:block th:replace="~{/administrator/fragments/admin_sidebar :: admin_sidebar}"></th:block>
  <div id="body-pd" class="body-pd">
    <h2 class="h2Title">실시간 채팅</h2>
    <hr/>
    <div class="admin-container">
      <main class="chat-main">
        <div class="chat-layout">
          <!-- 유저 목록 -->
          <div class="user-list" id="userList">
            <!-- 동적으로 유저 추가 -->
            <!-- 예시:
            <div class="user-item active" data-user="john_doe">
              <div class="profile-circle">JD</div>
              <div class="user-info">
                <strong>홍길동</strong>
                <span class="chat-type">객실 문의</span>
                <span class="last-message">안녕하세요</span>
              </div>
              <div class="badge">2</div>
            </div>
            -->
          </div>
          <!-- 채팅창 -->
          <div class="chat-panel">
            <div class="chat-header">
              <span id="chatWith">선택된 유저 없음</span>
              <span id="userStatus" style="margin-left:12px;font-size:0.95rem;color:#4a90e2;"></span>
            </div>
            <div class="chat-body" id="chatBody"></div>
            <div class="chat-input">
              <textarea id="messageInput" placeholder="메시지를 입력하세요..."></textarea>
              <button id="sendBtn">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle;">
                  <path d="M2 21L23 12L2 3V10L17 12L2 14V21Z" fill="white"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </main>
    </div>
    <script th:inline="javascript">
      var staffId = /*[[${staff_id}]]*/ null;
      if (typeof staffId === 'string' && staffId.startsWith('"') && staffId.endsWith('"')) {
        staffId = staffId.substring(1, staffId.length - 1);
      }
      if (staffId !== null) staffId = String(staffId);
      console.log("[admin_chat] staffId:", staffId, typeof staffId);
    </script>
    <script src="/js/admin_chat.js"></script>
  </div>
</body>
</html>