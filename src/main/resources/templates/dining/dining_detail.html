<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title th:text="${diningInfo.dining_name}">Insert title here</title>
<link rel="stylesheet" th:href="@{/css/header.css}" />
<link rel="stylesheet" th:href="@{/css/footer.css}" />

<!-- CSS 파일 포함 -->
<link rel="stylesheet" th:href="@{/dining/css/dining_detail.css}" />

</head>
<body>
<div th:replace="~{fragments/header :: header}"></div>
<div id="container">
<main id="content">
<!-- <div class="north-tab">
<i class="ico ico-breadcrumb-home" aria-hidden="true"></i>
<span>  >  다이닝  > <span>스테이,모던 레스토랑</span></span> 
</div> -->

<div class="main-img">
  <img th:src="@{${diningInfo.dining_main_image}}" alt="다이닝 메인 이미지" loading="lazy">
</div>
<div class="main-img-txt-area" th:text="${diningInfo.dining_name}">
스테이, 모던 레스토랑
</div>
<div class="content">
    <div class="category-wrap">
        <div class="category-img">
          <img th:src="@{${diningInfo.dining_logo_image}}" alt="다이닝 로고 이미지" loading="lazy">
        </div>
        <div class="category-copy" th:text="${diningInfo.dining_introduction}">소개내용</div>
    </div> 

    <div class="di-info-wrap">
        <div class="di-info-header">
            <h1 class="di-info-header-tit">다이닝 정보</h1>
        </div>
        <div class="info-list-wrap">
        
        <div class="info-list">
        <div class="info-row">
        <div class="list-col-1">
          <i class="ico ico-dining-type" aria-hidden="true"></i>
        타입
        </div>
        <div class="list-col-2" th:text="${diningInfo.type}">
        타입내용
        </div>
        </div>
        </div>
        <div class="info-list">
        <div class="info-row">
        <div class="list-col-1">
          <i class="ico ico-dining-location" aria-hidden="true"></i>
        위치
        </div>
        <div class="list-col-2" th:text="${diningInfo.location}">
        위치내용
        </div>
        </div>
        </div>
        <div class="info-list">
        <div class="info-row">
        <div class="list-col-1">
          <i class="ico ico-dining-opertime" aria-hidden="true"></i>
        영업시간
        </div>
        <div class="list-col-2" style="white-space: pre-line;" th:text="${diningInfo.dining_operation_hours}">
        영업시간내용
        </div>
        </div>
        </div>
        <div class="info-list">
        <div class="info-row">
        <div class="list-col-1">
          <i class="ico ico-dining-inquiry" aria-hidden="true"></i>
        문의 및 예약
        </div>
        <div class="list-col-2" style="display: flex; align-items: center;">
          <span th:text="${diningInfo.phone_number}">프렌치</span>
          <th:block th:if="${#strings.equalsIgnoreCase(#strings.trim(diningInfo.dining_resv_availability), 'Y')}">
            <a th:href="@{/diningResv(diningId=${diningInfo.dining_id})}" style="margin-left: 50px;">
              <button type="button" class="list-btn">예약하기</button>
            </a>
          </th:block>
        </div>
        </div>
        </div>
        </div>
    </div> 
    
    <div class="menu-wrap" th:if="${groupedMenuMap != null and !#maps.isEmpty(groupedMenuMap)}">
  <h1>대표메뉴</h1>
  <div class="menu-list-wrap">
    <th:block th:each="entry : ${groupedMenuMap}">
      <div class="menu-list">
        <div class="info-row" style="align-items: flex-start;">
          <div class="list-col-1" style="width: 300px;" th:text="${entry.key}"></div>
          <div class="list-col-2 menu-grid">
            <th:block th:each="menu : ${entry.value}">
              <div class="menu-item">
                <div th:text="${menu.menu_name}"></div>
                <div style="margin-top: 16px;">
                  <span th:text="${#numbers.formatInteger(menu.price, 0, 'COMMA')}"></span> KRW
                </div>
              </div>
            </th:block>
          </div>
        </div>
      </div>
    </th:block>
  </div>
</div>
    
    <div class="gallery-wrap" th:if="${diningInfo.dining_carousel_images != null and #lists.size(diningInfo.dining_carousel_images) > 0}">
      <div class="gallery-flex-row">
        <h1 class="gallery-title">갤러리</h1>
        <div class="gallery-carousel">
        <!-- 이미지가 있을 때  여기가 dining_carousel_images들어갈 에정-->
        <div class="gallery-image-area" th:if="${diningInfo.dining_carousel_images != null and #lists.size(diningInfo.dining_carousel_images) > 0}">
          <img th:src="@{${diningInfo.dining_carousel_images[0]}}" alt="갤러리 이미지" id="gallery-main-img">
        </div>
        <!-- 이미지가 없을 때 -->
        <div class="gallery-image-area" th:if="${diningInfo.dining_carousel_images == null or #lists.size(diningInfo.dining_carousel_images) == 0}">
          <img src="/dining/images/no_image.png" alt="이미지 없음" id="gallery-main-img">
        </div>
        <div class="gallery-controls">
          <!-- 프로그래스바 -->
          <div class="gallery-progress-bar">
            <div class="gallery-progress" id="gallery-progress"></div>
          </div>
          <span id="gallery-index">
            <span id="gallery-current">1</span>/<span id="gallery-total">1</span>
          </span>
          <!-- pagination 스타일 버튼 -->
          <button class="mimir-pg-btn" id="gallery-prev" disabled>
            <img src="/pagination/images/prevPage_enable.svg" alt="이전">
          </button>
          <button class="mimir-pg-btn" id="gallery-next">
            <img src="/pagination/images/nextPage_enable.svg" alt="다음">
          </button>
        </div>
      </div>
      <!-- 갤러리 이미지 리스트(숨김, JS에서 사용) -->
      <div id="gallery-image-list" style="display:none;">
        <span th:each="img : ${diningInfo.dining_carousel_images}" th:text="${img}"></span>
      </div>
    </div>
  </div> 
    
    <!-- 추가 정보 섹션 -->
    <div class="additional-info-wrap" th:if="${diningInfo.dining_detailinfo != null and !#strings.isEmpty(diningInfo.dining_detailinfo)}">
      <h1 class="gallery-title">추가 정보</h1>
      <div class="additional-info-content-bg">
        <div class="additional-info-content" style="color:#707070" th:utext="${diningInfo.dining_detailinfo}"></div>
      </div>
    </div>
    <hr class="section-divider">
    <div class="btn-area">
      <a th:href="@{/user/dining_main}"><button type="button" class="list-btn">목록</button></a>
    </div>

<!-- 화면 우측 하단 예약하기 플로팅 버튼 -->
<a href="#" class="floating-reserve-btn" onclick="openReservationPanel(event)">
  <img src="/dining/images/reservation_calender.svg" alt="예약 아이콘" class="reserve-icon">
  <span class="reserve-text">예약하기</span>
</a>

<!-- 예약 패널 (오른쪽) -->
<div id="reservation-panel" class="reservation-panel">
  <div class="reservation-header">
    <h3>다이닝 예약</h3>
    <button class="close-btn" onclick="closeReservationPanel()">×</button>
  </div>
  <div class="reservation-content">
    <div class="dining-info" onclick="openDiningModal()" style="cursor: pointer;">
      <h4>다이닝</h4>
      <p id="selected-dining-name" style="color:#333;"></p>
      <span style="font-size: 12px; color: #666;">클릭하여 변경</span>
    </div>
    <div class="guest-info" onclick="openGuestModal()" style="cursor: pointer;">
      <h4>인원</h4>
      <div class="guest-summary">
        <span>성인 <span id="adult-count">0</span></span>
        <span>어린이 <span id="child-count">0</span></span>
      </div>
      <span style="font-size: 12px; color: #666;">클릭하여 변경</span>
    </div>
    <button class="search-btn" id="reservation-search-btn" onclick="searchReservation()" disabled>예약하기</button>
  </div>
</div>

<!-- 다이닝 선택 모달 (왼쪽 슬라이드) -->
<div id="dining-modal" class="modal-slide">
  <div class="modal-content">
    <div class="modal-header">
      <h3>다이닝 선택</h3>
      <button class="close-btn" onclick="closeDiningModal()">×</button>
    </div>
    <div class="dining-options" id="dining-options-list">
      <!-- JS로 예약 가능 다이닝 옵션 동적 렌더링 -->
    </div>
    <button class="select-btn" onclick="confirmDiningSelection()">선택</button>
  </div>
</div>

<!-- 인원수 선택 모달 (왼쪽 슬라이드) -->
<div id="guest-modal" class="modal-slide">
  <div class="modal-content">
    <div class="modal-header">
      <h3>인원수</h3>
      <button class="close-btn" onclick="closeGuestModal()">×</button>
    </div>
    <div class="guest-selection">
      <div class="guest-type">
        <span>성인</span>
        <div class="counter">
          <button onclick="decreaseCount('adult')">-</button>
          <span id="adult-counter">0</span>
          <button onclick="increaseCount('adult')">+</button>
        </div>
      </div>
      <div class="guest-type">
        <span>어린이</span>
        <div class="counter">
          <button onclick="decreaseCount('child')">-</button>
          <span id="child-counter">0</span>
          <button onclick="increaseCount('child')">+</button>
        </div>
      </div>
      <!-- 유아 관련 UI 제거 -->
    </div>
    <button class="select-btn" onclick="confirmGuestSelection()">선택</button>
  </div>
</div>

<!-- 배경 오버레이 -->
<div id="overlay" class="overlay" onclick="closeAllModals()"></div>


</main>
<!-- 푸터 삽입 -->
    <div th:replace="fragments/footer :: footerFragment"></div>
</div>

<!-- JavaScript 파일 포함 -->
<script th:src="@{/dining/js/dining_detail.js}"></script>
</body>
</html>