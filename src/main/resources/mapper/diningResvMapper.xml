<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.sist.diningresv.DiningResvMapper">

  <select id="selectAllResv" resultType="kr.co.sist.diningresv.DiningResvDTO">
    SELECT 
      r.RESERVATION_ID AS reservationId,
      r.RESERVATION_NAME AS reservationName,
      r.RESERVATION_TELL AS reservationTel,
      r.RESERVATION_DATE AS reservationDate,
      r.RESERVATION_TIME AS reservationTime,
      r.RESERVATION_COUNT AS reservationCount,
      r.RESERVATION_STATUS AS reservationStatus,
      r.RESERVATION_REQUEST AS reservationRequest,
      
      r.DINING_ID AS diningId,
      d.DINING_NAME AS diningName,

      u.USER_NUM AS userNum,
      u.USER_NAME AS userName,
      u.TEL AS userTel,
      u.EMAIL_ID AS userEmail,

      n.NON_MEM_ID AS nonMemId,
      n.NON_MEM_NAME AS nonMemName,
      n.NON_MEM_TEL AS nonMemTel,

      p.PAYMENT_ID AS paymentId,
      p.PAYMENT_PRICE AS paymentPrice

    FROM 
      DINING_RESERVATION r
      LEFT JOIN DINING d ON r.DINING_ID = d.DINING_ID
      LEFT JOIN MIMIR_USER u ON r.USER_NUM = u.USER_NUM
      LEFT JOIN NON_MEMBER n ON r.NON_MEM_ID = n.NON_MEM_ID
      LEFT JOIN PAYMENT p ON r.RESERVATION_ID = p.RESERVATION_ID

    ORDER BY r.RESERVATION_DATE DESC, r.RESERVATION_TIME DESC
  </select>

</mapper>